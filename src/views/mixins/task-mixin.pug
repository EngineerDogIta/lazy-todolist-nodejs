mixin renderTask(task)
  .list-group-item.d-flex.justify-content-between.align-items-center.animate__animated.animate__fadeIn.task-item(
    data-testid=`todo-item-${task.id}`
    class=`task-depth-${task.depth}`
  )
    .task-content
      span.task-title(data-testid=`todo-title-${task.id}`) #{task.title}
      if task.childTasks && task.childTasks.length > 0
        span.badge.badge-primary.ml-2 #{task.childTasks.length}
    .task-actions
      button.btn.btn-outline-primary.btn-sm.mr-2(
        type="button"
        onclick=`toggleSubtaskForm(${task.id})`
        data-testid=`todo-add-subtask-${task.id}`
      )
        i.fa.fa-plus.mr-1
        | Add Subtask
      form.d-inline(action="/" method="post")
        input(type="hidden", name="taskId" value=task.id)
        input(type="hidden", name="action" value="delete")
        button.btn.btn-outline-danger.btn-sm(
          type="submit"
          title="Delete"
          data-testid=`todo-delete-${task.id}`
        )
          i.fa.fa-trash.mr-1
          | Delete
    
    form.subtask-form.d-none(
      id=`subtask-form-${task.id}`
      action="/"
      method="post"
    )
      .input-group.mt-2
        input.form-control(
          type="text"
          name="taskText"
          placeholder="Enter subtask..."
          required
        )
        input(type="hidden" name="parentId" value=task.id)
        input(type="hidden" name="action" value="add-subtask")
        .input-group-append
          button.btn.btn-primary(type="submit") Add

  if task.childTasks && task.childTasks.length > 0
    .subtasks.ml-4
      each childTask in task.childTasks
        +renderTask(childTask) 